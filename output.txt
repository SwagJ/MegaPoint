/Users/luyifan/opt/anaconda3/bin/python3.7 /Users/luyifan/PycharmProjects/SuperPoint/superpoint/great_point_test.py
/Users/luyifan/PycharmProjects/SuperPoint/superpoint
2020-05-21 01:18:42.380383: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2020-05-21 01:18:42.396231: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7ffe8cc94bf0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 01:18:42.396247: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
total:Tensor("GreatPoint/Cast_1:0", shape=(None,), dtype=float32)
Traceback (most recent call last):
  File "/Users/luyifan/PycharmProjects/SuperPoint/superpoint/great_point_test.py", line 26, in <module>
    gp.predict(x=X)
  File "/Users/luyifan/opt/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training.py", line 1013, in predict
    use_multiprocessing=use_multiprocessing)
  File "/Users/luyifan/opt/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2.py", line 498, in predict
    workers=workers, use_multiprocessing=use_multiprocessing, **kwargs)
  File "/Users/luyifan/opt/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2.py", line 426, in _model_iteration
    use_multiprocessing=use_multiprocessing)
  File "/Users/luyifan/opt/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2.py", line 646, in _process_inputs
    x, y, sample_weight=sample_weights)
  File "/Users/luyifan/opt/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training.py", line 2346, in _standardize_user_data
    all_inputs, y_input, dict_inputs = self._build_model_with_inputs(x, y)
  File "/Users/luyifan/opt/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training.py", line 2572, in _build_model_with_inputs
    self._set_inputs(cast_inputs)
  File "/Users/luyifan/opt/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training.py", line 2659, in _set_inputs
    outputs = self(inputs, **kwargs)
  File "/Users/luyifan/opt/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/base_layer.py", line 773, in __call__
    outputs = call_fn(cast_inputs, *args, **kwargs)
  File "/Users/luyifan/opt/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/autograph/impl/api.py", line 237, in wrapper
    raise e.ag_error_metadata.to_exception(e)
ValueError: in converted code:

    /Users/luyifan/PycharmProjects/SuperPoint/superpoint/models/great_point.py:78 call  *
        s1 = self.super_point({'input_1' : image0})
    /Users/luyifan/opt/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/base_layer.py:773 __call__
        outputs = call_fn(cast_inputs, *args, **kwargs)
    /Users/luyifan/PycharmProjects/SuperPoint/superpoint/models/super_point.py:151 call  *
        _logits, _prob, _descriptors_raw, _desc_processed = self._net_image(image)
    /Users/luyifan/opt/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/base_layer.py:773 __call__
        outputs = call_fn(cast_inputs, *args, **kwargs)
    /Users/luyifan/PycharmProjects/SuperPoint/superpoint/models/super_point.py:76 call  *
        _features = self.features(image)
    /Users/luyifan/opt/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/base_layer.py:773 __call__
        outputs = call_fn(cast_inputs, *args, **kwargs)
    /Users/luyifan/PycharmProjects/SuperPoint/superpoint/models/backbones/vgg.py:62 call  *
        _x = self.conv1_1(x)
    /Users/luyifan/opt/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/base_layer.py:773 __call__
        outputs = call_fn(cast_inputs, *args, **kwargs)
    /Users/luyifan/PycharmProjects/SuperPoint/superpoint/models/backbones/vgg.py:20 call  *
        out = self.conv(inputs)
    /Users/luyifan/opt/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/base_layer.py:737 __call__
        self.name)
    /Users/luyifan/opt/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/input_spec.py:165 assert_input_compatibility
        layer_name + ' is incompatible with the layer: '

    ValueError: Input 0 of layer conv2d_156 is incompatible with the layer: its rank is undefined, but the layer requires a defined rank.


Process finished with exit code 1
